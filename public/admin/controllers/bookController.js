// Generated by CoffeeScript 1.6.3
angular.module('learnPubApp').directive("checkboxM", function() {
  return {
    require: 'ngModel',
    priority: 10000,
    compile: function(element, attributes){

         return {
               pre: function($scope, element, attributes, ngModelController) {
                  console.log($scope, element, attributes);
                  ngModelController.$parsers.push(function(data) {
                   //convert data from view format to model format
                   return (data == true) ? "1" : "0";
                 });

                 //attributes.$set('ng-checked', true);

                 ngModelController.$formatters.push(function(data) {
                   //convert data from model format to view format
                   console.log(data);
                   return (data == "1") ? true : false;
                 });
              },
             post: function(scope, element, attributes, controller, transcludeFn){

             }
         }
     },
    // link: {
    //       pre: function($scope, element, attributes, ngModelController) {
    //          console.log($scope, element, attributes);
    //          ngModelController.$parsers.push(function(data) {
    //           //convert data from view format to model format
    //           console.log(data);
    //           return (data == true) ? "1" : "0";
    //         });
    //
    //         ngModelController.$formatters.push(function(data) {
    //           //convert data from model format to view format
    //           return (data == "1") ? true : false;
    //         });
    //      }
    // }
  };
});

angular.module('learnPubApp').controller('bookController', function($scope, $state, $stateParams, BookService) {
  //
  // if ($stateParams.id === null) {
  //   $scope.book = JSON.parse(localStorage.getItem("book"));
  // } else {
  //   $scope.book = $stateParams.book;
  //   localStorage.setItem("book", JSON.stringify($scope.book));
  // }

  BookService.findBook($stateParams.id).then(function(response) {
    if (response.data.status == true) {
      $scope.book = response.data.result;
    }
  });

});
